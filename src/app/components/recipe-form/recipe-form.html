<div class="container">
  <h2>{{ isEditMode ? 'Edit Recipe' : 'Add New Recipe' }}</h2>
  <p *ngIf="loading">Loading recipe...</p>

  <form [formGroup]="recipeForm" (ngSubmit)="onSubmit()" *ngIf="!loading">

    <fieldset>
      <legend>Recipe Details</legend>

      <div>
        <label for="name">Recipe Name *</label>
        <input id="name" type="text" formControlName="name">
        <div *ngIf="recipeForm.get('name')?.invalid && recipeForm.get('name')?.touched" class="error-message">Name is required.</div>
      </div>

      <div>
        <label for="category">Category *</label>
        <select id="category" formControlName="category">
          <option value="Dinner">Dinner</option>
          <option value="Dessert">Dessert</option>
          <option value="Breakfast">Breakfast</option>
        </select>
      </div>

      <div>
        <label for="prepTime">Prep Time</label>
        <input id="prepTime" type="text" formControlName="prepTime">
      </div>

      <div>
        <label for="difficulty">Difficulty *</label>
        <select id="difficulty" formControlName="difficulty">
          <option value="Easy">Easy</option>
          <option value="Medium">Medium</option>
          <option value="Hard">Hard</option>
        </select>
      </div>

      <div>
        <label for="instructions">Instructions *</label>
        <textarea id="instructions" formControlName="instructions" rows="6"></textarea>
      </div>
    </fieldset>

    <fieldset [formArrayName]="'ingredients'">
      <legend>Ingredients</legend>

      <div *ngFor="let ingredientGroup of ingredientsArray.controls; let i = index"
           [formGroupName]="i" class="ingredient-row">

        <input type="hidden" formControlName="id">

        <input type="text" formControlName="quantity" placeholder="Quantity (e.g., 2 cups)">
        <input type="text" formControlName="name" placeholder="Ingredient Name (e.g., Flour)">

        <button type="button" (click)="removeIngredient(i)" class="remove-ingredient">Remove</button>
      </div>

      <button type="button" (click)="addIngredient()" class="add-ingredient-btn">âž• Add Ingredient</button>
    </fieldset>

    <div class="actions">
      <button type="submit" [disabled]="recipeForm.invalid" id="save-btn">
        {{ isEditMode ? 'Save Changes' : 'Create Recipe' }}
      </button>
      <button type="button" routerLink="/" class="btn-cancel">Cancel</button>
    </div>

  </form>
</div>
